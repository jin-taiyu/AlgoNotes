### 2024年3月24日

今天继续学习数论和线性代数。从昨天*费马小定理*等等问题遗留的*同余问题*开始。

1. 同余

   同余是数论的一个基本理论，能够用等式的形式简洁地描述整除关系

   1. 同余的定义

      **同余**：设 $m$ 是正整数，若 $a$ 和 $b$ 是整数，且 $m \mid (a - b)$ ，则称 $a$ 和 $b$ 模 $m$ 同余。也就是说， $a$ 除以 $m$ 得到的余数和 $b$ 除以 $m$ 的余数相同。再或者说， $a - b$ 除以 $m$ ，余数为 $0$ 。

      

      **剩余系**：一个模 $m$ 完全剩余系是一个整数的集合，使每个整数恰与此集合中的一个元素模 $m$ 同余。

   2. 一些定理和性质

      若 $a$ 和 $b$ 是整数， $m$ 为正整数，则 $a \equiv b \pmod{m}$ 当且仅当 $a \mod{m} = b \mod{m}$ ，当且仅当存在整数 $k$ 使得 $a = b + km$ 。

      满足性质：

      - 自反性： $a \equiv a \pmod{m}$ 
      - 对称性： $a \equiv b \pmod{m}$ 则 $b \equiv a \pmod{m}$ 
      - 传递性： $a \equiv b \pmod{m}$ 且 $b \equiv c \pmod{m}$ 则 $a \equiv c \pmod{m}$ 

2. 一元线性同余方程

   形如 $$ax\equiv b\pmod n$$ 的方程称为 **线性同余方程**（Linear Congruence Equation）。其中，$a$、$b$ 和 $n$ 为给定整数，$x$ 为未知数。需要从区间 $[0, n-1]$ 中求解 $x$，当解不唯一时需要求出全体解。

   $ax\equiv b\pmod n$ 表示 $ax - b$ 是 $m$ 的倍数，即 $ax + my = b$​ ，这是二元线性丢番图方程。（绷不住了，之前觉得线性丢番图没用就没学，现在看来还是得看一下）

   

   `丢番图方程`：

   方程 $ax + by = c$ 被称为二元线性丢番图方程，其中 $a, b, c$ 是已知整数， $x, y$​ 是变量，问是否有整数解。其实际上是二维 $x-y$​ 平面的一条直线，这条直线上如果有**整数坐标点**，方程就有解。

   `定理`：

   设 $a, b$ 是整数且 $\gcd(a, b) = d$ ，如果 $d$ 不能整除 $c$ ，那么方程 $ax + by = c$ 没有整数解，如果 $d$ 能整除 $c$ ，那么存在无穷多个整数解。另外，如果 $(x_{0}, y_{0})$ 是方程的一个特解，那么所有解（通解）可以表示为 $x = x_{0} + (b /d)n, y = y_{0} - (a / d)n$ ，其中 $n$ 为任意整数。

   概括为 $ax + by = c$ 有解的充分必要条件为 $d = \gcd(a, b)$ 能整除 $c$ ，即 $d = \gcd(a, b) \mid c$ 。

   

   回到一元线性同余方程

   **定理**：

   设 $a,b$ 和 $m$ 是整数， $m > 0$ ， $\gcd(a, m) = d$ 。

   - 若 $d$ 不能整除 $b$ ，则 $ax \equiv b \pmod{m}$ 无解；
   - 若 $d$ 能整除 $b$ ，则有 $d$​ 个不同余的解。

   这个定理的前后部分可以概括为：

   -  $ax \equiv b \pmod{m}$ 有解的充要条件是 $\gcd(a, m) \mid b$ 
   - 有 $d$ 个模 $m$ 不同余的解（剩余定理：$n$ 取遍了模 $d$ 的完全剩余系）

   **推论**：

   $a$ 和 $m$ 互素时，因为 $d = \gcd(a, m) = 1$ ，所以线性同余方程 $ax \equiv \pmod{m}$ 有唯一的模 $m$​ 不同余的解

3. 逆

   解一元线性同余方程需要用到*逆(Inverse)元*

   1. 逆的概念

      给定整数 $a$ ，且满足 $\gcd(a, m) = 1$ ，称 $ax \equiv 1 \pmod{m}$ 的一个解为 $a$ 模 $m$ 的逆，记为 $a^{-1}$ 。 （$a \cdot a^{-1} \mod{m} = 1 \mod{m} = 1$ ）

      e.g： $8x = 1 \pmod{31}$ ，$4, 35, 66$ 等等解都是 $8$ 模 $31$ 的逆。

   2. 求逆

      有多种方法可以求逆

      1. 扩展欧几里得算法求单个逆

         求解同余方程 $ax \equiv 1 \pmod{m}$ 如下：

         ```c++
         ll mod_inverse(ll a, ll b) {
           ll x, y;
           extend_gcd(a, m, x, y);
           return (x % m + m) % m;
         }
         int main() {
           ll a, m; cin >> a >> m;
           cout << mod_inverse(a, m);
           return 0;
         }
         ```

         $ax = 1 \pmod{m}$ ，即丢番图方程 $ax + my = 1$ ，先用扩展欧几里得算法求出 $ax + my = 1$ 的一个特解 $x_{0}$ ，通解是 $x = x_{0} + mn$ 。然后通过取模操作计算最小整数解 $((x_{0} \mod{m}) + m) \mod{m}$ ，因为 $m > 0$ ，可以保证结果是正整数。

      2. 费马小定理求单个逆

      3. 递推求多个逆